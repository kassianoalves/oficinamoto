<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Integra√ß√£o - Oficina Moto</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
        }
        .section {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #764ba2;
        }
        .success { color: green; }
        .error { color: red; }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üèçÔ∏è Teste de Integra√ß√£o - Oficina Moto</h1>
    
    <div class="section">
        <h2>1. Teste de Conex√£o com Backend</h2>
        <button onclick="testarBackend()">Testar Conex√£o</button>
        <div id="resultado-backend"></div>
    </div>

    <div class="section">
        <h2>2. Teste de GET /api/clientes/</h2>
        <button onclick="testarGetClientes()">Carregar Clientes</button>
        <div id="resultado-get"></div>
    </div>

    <div class="section">
        <h2>3. Teste de POST /api/clientes/</h2>
        <button onclick="testarPostCliente()">Criar Cliente Teste</button>
        <div id="resultado-post"></div>
    </div>

    <div class="section">
        <h2>4. Informa√ß√µes do Navegador</h2>
        <pre id="info-navegador"></pre>
    </div>

    <script>
        const API_URL = 'http://127.0.0.1:8000/api';

        function mostrarResultado(elementId, titulo, dados) {
            const elemento = document.getElementById(elementId);
            elemento.innerHTML = `<h3>${titulo}</h3><pre>${JSON.stringify(dados, null, 2)}</pre>`;
        }

        function testarBackend() {
            fetch('http://127.0.0.1:8000/')
                .then(r => {
                    mostrarResultado('resultado-backend', 'Resultado', {
                        status: r.status,
                        statusText: r.statusText,
                        url: r.url,
                        mensagem: 'Backend est√° respondendo ‚úì'
                    });
                })
                .catch(e => {
                    mostrarResultado('resultado-backend', 'Erro', {
                        erro: e.message,
                        tipo: e.constructor.name
                    });
                });
        }

        function testarGetClientes() {
            fetch(`${API_URL}/clientes/`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(r => r.json())
                .then(data => {
                    mostrarResultado('resultado-get', 'Clientes Carregados', data);
                })
                .catch(e => {
                    mostrarResultado('resultado-get', 'Erro ao Carregar', {
                        erro: e.message
                    });
                });
        }

        function testarPostCliente() {
            const novoCliente = {
                nome: 'Cliente ' + new Date().getTime(),
                cpf: Math.random().toString().slice(2, 12),
                email: 'teste@test.com',
                telefone: '1234567890',
                endereco: 'Rua Teste',
                cidade: 'Teste'
            };

            fetch(`${API_URL}/clientes/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(novoCliente)
            })
                .then(r => r.json())
                .then(data => {
                    mostrarResultado('resultado-post', 'Cliente Criado', data);
                })
                .catch(e => {
                    mostrarResultado('resultado-post', 'Erro ao Criar', {
                        erro: e.message
                    });
                });
        }

        // Mostrar informa√ß√µes do navegador
        document.getElementById('info-navegador').textContent = JSON.stringify({
            url: window.location.href,
            origin: window.location.origin,
            userAgent: navigator.userAgent,
            apiUrl: API_URL
        }, null, 2);
    </script>
</body>
</html>
